<!DOCTYPE html>
<html lang='en'>
<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet"> 
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="{{url_for('static', filename='style.css')}}">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
    <body>
        {% set colors = "100%, 29.6%" %}
        {% if page == 'index' %}
        <div>
            <div class='card text_card card-body' id='intro'>
                <h1 id='header'>LHS Admissions Calculator</h1>
                <p>Do you ever wonder what your chance of admission to colleges are? The LHS Admissions Calculator uses Lexington High School's Naviance scatterplot data to model the percent of LHS students with your GPA and/or SAT who will get in to various colleges.
                <a href='about'>Read more about the methodology and creator.</a></p>
                <p>To use, just input your GPA and/or SAT and colleges and the list of colleges at the bottom of the page will fill with percents.</p>
            </div>
            <div id='accordion2'>
                <div class='card'>
                    <div class="card-header" id="heading_contact">
                        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapse_contact">
                            Contact me to request a college to be added, give feedback, or ask a question!
                        </button>
                    </div>
                    <div id="collapse_contact" class="collapse" aria-labelledby="heading_contact" data-parent="#accordion2">
                        <form class='card-body' method='POST' action='contact'>
                            <label class='form-label' for='email'>Email address (Optional. I will also never send you spam.)</label>
                            <input type='email' name='email' placeholder='ex. johnsmith@gmail.com or 23smith420@lexingtonma.org' class='form-control'>
                            <textarea class='form-control' name='text' rows='5' cols='40'></textarea>
                            <button type='submit' class='btn btn-success'>Send</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!--<div class='card card-body'>-->
            <form class='card card-body' method='POST'>
                <label for='GPA' class='form-label'>LHS Unweighted GPA</label>
                <input type='number' name='GPA' min='1' max='4.33' step='any'
                   value='{{session['GPA']}}' placeholder='ex. 3.82'
                   class='form-control'>
                <label for='SAT' class='form-label'>SAT</label>
                <input type='number' name='SAT' min='400' max='1600' step='10'
                   value='{{session['SAT']}}' placeholder='ex. 1410'
                   class='form-control'>
                <button type='submit' class='btn btn-success'>Save percents</button>
            </form>
            <!--</div>-->
        <div id='search_space'>
            <a name='search_area'></a>
            <form method='POST' class='card card-body'>
                <p>Search the <strong>full name</strong> of an available college here or see lists of colleges below</p>
                <input class="form-control" name='college' list="datalistOptions" placeholder="ex. Massachusetts Institute of Technology" value='{{session['college']}}' pattern='{{pattern}}'>
                <datalist id='datalistOptions'>
                    {% for college in chances.index %}
                        <option value='{{college}}'>
                    {% endfor %}
                </datalist>
                <button type='submit' class='btn btn-success'>See percent</button>
                {% if session['college'] %}
                    <hr/>
                    <p id='college' class='search_college'>{{session['college']}}</p>
                    <p id='chance' class='search_college'
                        {% set college_chance = chances['chance'][session['college']] %}
                        {% set college_color = color(college_chance) %}
                        {% if math.isnan(college_color) %}
                            >{{college_chance}}
                        {% else %}
                        style='color:hsla({{college_color}}, {{colors}}, 1);'>{{college_chance}}%
                        <!--100, 35 -->
                        {% endif %}
                    </p>
                {% endif %}
            </form>
        </div>
        <div id='accordion'>
            {% set open = 'recently_accepted' %}
            {% set messages = {'recently_accepted': '⚫ Colleges that have accepted LHS students since 2018', 'not_recently_accepted': '⚪ Colleges that accepted 0 LHS students since 2018'} %}
            {% for index, value in chances_groups.items() %}
                <div class='card'>
                    <div class="card-header" id="heading_{{index}}">
                        <button class="btn btn-link
                            {% if not index == open %}
                                collapsed
                            {% endif %}
                            " data-toggle="collapse" data-target="#collapse_{{index}}">
                            {{messages[index]}}
                        </button>
                    </div>

                    <div id="collapse_{{index}}" class="collapse
                        {% if index == open %}
                            show
                        {% endif %}
                        " aria-labelledby="heading_{{index}}" data-parent="#accordion">
                        <div class="card-body">
                            <table class='table'>
                                <thead class='table-light'>
                                    <tr>
                                        <th scope='col'>Available colleges</th>
                                        <th scope='col'>Percent</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for index, value in value.iterrows() %}
                                        {% if not session['GPA'] and not session['SAT'] and value['info'] == 'const_only' %}
                                        {% elif len(value['missing']) > 0%}
                                            <tr class='table-active'>
                                                <td>{{index}}</td>
                                                <td>{{value['chance']}}</td>
                                            </tr>
                                        {% else %}
                                            <tr >
                                                <td>{{index}}</td>
                                                <td style='color:hsla(
                                                    {{color(value['chance'])}}
                                                    , {{colors}}, 1);'>{{value['chance']}}%</td>
                                            </tr>
                                        {% endif %}
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
        {% elif page == 'about' %}
        <div>
            <div class='card card-body'>
                <h1 id='about_header'><a href='/'>LHS Admissions Calculator</a></h1>
            </div>
            <div id='accordion2'>
                <div class='card'>
                    <div class="card-header" id="heading_contact">
                        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapse_contact">
                            Contact me to request a college to be added, give feedback, or ask a question!
                        </button>
                    </div>
                    <div id="collapse_contact" class="collapse" aria-labelledby="heading_contact" data-parent="#accordion2">
                        <form method='POST' action='contact' class='card-body'>
                            <label class='form-label' for='email'>Email address (Optional. I will also never send you spam.)</label>
                            <input type='email' name='email' placeholder='ex. johnsmith@gmail.com or 23smith420@lexingtonma.org' class='form-control'>
                            <textarea class='form-control' name='text' rows='5' cols='40'></textarea>
                            <button type='submit' class='btn btn-success'>Send</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class='card text_card card-body'>
            <p>Hi! I'm Franca Ellerman and I'm in the class of 2023 at Lexington High School, MA.</p>
            <p>To make the LHS Admissions Calculator, I used scatterplot data of anonymized LHS students you can find by logging into Naviance with an LHS account. It models, on average, how many people with your GPA and SAT will be accepted to each college, not your personal chances of getting in (correlation ≠ causation). The Naviance data is also opt-in so there could be bias in the results. I also do not distinguish between normal decision, Early Action, or Early Decision because of inconsistencies in Naviance's data.</p>
            <p>Some colleges are listed as not having accepted any LHS students since 2018. Many are in this category because of an effect called yield protection. So many people at LHS get into extremely selective schools like those in the Ivy League, they chose Harvard over slightly less selective schools. This makes those slightly less elite schools worried that if they admit someone from LHS they won't go, so as a result they've stopped admitting LHS students.</p>
            <p>I hope you use this tool to get a snapshot sense of your chances at different schools instead of eyeballing it in the Naviance scatterplots! Please contact me in the form above with feedback on the site or any questions you have.</p>
        </div>
        {% endif %}
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    </body>
</html>

